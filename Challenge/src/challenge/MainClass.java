package challenge;

import java.io.IOException;
import java.net.URISyntaxException;
import java.sql.Connection;
import java.util.List;

//TODO: POST. TEST! (how?)
//TODO: decide the attacks (think through)
//TODO: test main
//TODO: test cases (JUnit in POM done)

//TODO: what to do with redirects?
//TODO (option) : image
public class MainClass {
	
	public static void main(String[] args) throws IOException, URISyntaxException {
		Connection conn = DataBaseManager.connect("database.properties");
		DataBaseManager.start(conn);
		
		String attackFile ="./strings.json";
		
		String url = args[0];
		String cookie = "";
		if(args.length>1){
			cookie = args[1];
		}
		List<String> params = AttackManager.attack(url, attackFile, cookie);
		if(params!=null){
			DataBaseManager.addURL(conn, url, params.toArray(new String[params.size()]));
		}
	}
}
