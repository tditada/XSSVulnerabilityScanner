package tests;

import java.io.IOException;
import java.net.URISyntaxException;
import java.util.List;

import org.junit.Test;

import challenge.AttackManager;

public class AttacksTests {

	/**
	 * Basic test to see if https://xss-game.appspot.com level1 page is XSS vulnerable. 
	 * The page have known Reflective XSS vulnerabilities.	 * 
	 * @throws IOException
	 * @throws URISyntaxException
	 */
	@Test
	public void testXssGameIsVulnerableReflectiveXSS() throws IOException, URISyntaxException {
		List<String> params = AttackManager.attack("https://xss-game.appspot.com/level1/frame", "./strings.json", "");
		assert(params != null);
	}

	/** Tests that google-gruyere instance is vulnerable to Reflective XSS.
	 * @throws IOException
	 * @throws URISyntaxException
	 */
	@Test
	public void testGoogleGruyereisVulnerableReflectiveXSS() throws IOException, URISyntaxException{
		List<String> params = AttackManager.attack("https://google-gruyere.appspot.com/683962442778", "./strings.json", "");
		assert(params != null);
	}
	
	/** Tests that google-gruyere instance is vulnerable to Stored XSS if we have a known cookie.
	 * @throws IOException
	 * @throws URISyntaxException
	 */
	@Test
	public void testGoogleGruyereisVulnerableStoredXSS() throws IOException, URISyntaxException{
		List<String> params = AttackManager.attack("https://google-gruyere.appspot.com/683962442778/newsnippet.gtl", "./strings.json", "GRUYERE=91551079|asd||author; GRUYERE_ID=683962442778");
		assert(params!=null);
	}
}
