package tests;

import static org.junit.Assert.assertTrue;

import java.io.IOException;
import java.net.URISyntaxException;
import java.util.List;

import org.junit.Test;

import challenge.AttackManager;

/**
 * @author tere
 *
 */
public class AttacksTests {

	/**
	 * Basic test to see if https://xss-game.appspot.com level1 page is XSS vulnerable. 
	 * The page have known Reflective XSS vulnerabilities.	 * 
	 * @throws IOException
	 * @throws URISyntaxException
	 */
	@Test
	public void testXssGameIsVulnerableReflectiveXSS() throws IOException, URISyntaxException {
		List<String> params = AttackManager.attack("https://xss-game.appspot.com/level1/frame", "./strings.json", "");
		assertTrue(params != null);
	}

	/** Tests that google-gruyere instance is vulnerable to Reflective XSS.
	 * @throws IOException
	 * @throws URISyntaxException
	 */
	@Test
	public void testGoogleGruyereisVulnerableReflectiveXSS() throws IOException, URISyntaxException{
		List<String> params = AttackManager.attack("https://google-gruyere.appspot.com/683962442778", "./strings.json", "");
		assertTrue(params != null);
	}
	
	/** Tests that google-gruyere instance is vulnerable to (Stored) XSS if we have a known cookie.
	 * @throws IOException
	 * @throws URISyntaxException
	 */
	@Test
	public void testGoogleGruyereisVulnerableStoredXSS() throws IOException, URISyntaxException{
		List<String> params = AttackManager.attack("https://google-gruyere.appspot.com/683962442778/newsnippet.gtl", "./strings.json", "GRUYERE=91551079|asd||author; GRUYERE_ID=683962442778");
		assertTrue(params!=null);
	}
	
	
//	/** Tests Damn Vulnerable Web App (this is running in an apache service on a personal computer) for Reflective XSS
//	 * Cookie have to be passed because the app needs it to get throught the login. 
//	 * Security difficulty is set in high
//	 * @throws IOException
//	 * @throws URISyntaxException
//	 */
//	@Test
//	public void testDVWAReflectiveXSSLevelHigh() throws IOException, URISyntaxException{
//		List<String> params = AttackManager.attack("http://192.168.0.13/dvwa/vulnerabilities/xss_r/","./strings.json","security=high; PHPSESSID=d3s089m3kvasiq77jaf7jf9ik6");
//		assertTrue(params!=null);
//	}
}
