package tests;

import static org.junit.Assert.assertTrue;

import java.io.IOException;
import java.net.URISyntaxException;
import java.util.List;

import org.junit.Test;

import challenge.AttackManager;

/**
 * @author tere
 *
 */
public class AttacksTests {

//	/**
//	 * Basic test to see if https://xss-game.appspot.com level1 page is XSS vulnerable. 
//	 * The page have known Reflective XSS vulnerabilities.	 * 
//	 * @throws IOException
//	 * @throws URISyntaxException
//	 */
//	@Test
//	public void testXssGameIsVulnerableReflectiveXSS() throws IOException, URISyntaxException {
//		List<String> params = AttackManager.attack("https://xss-game.appspot.com/level1/frame", "./strings.json", "");
//		assertTrue(params != null);
//	}
//
//	/** Tests that google-gruyere instance is vulnerable to Reflective XSS.
//	 * @throws IOException
//	 * @throws URISyntaxException
//	 */
//	@Test
//	public void testGoogleGruyereisVulnerableReflectiveXSS() throws IOException, URISyntaxException{
//		List<String> params = AttackManager.attack("https://google-gruyere.appspot.com/683962442778", "./strings.json", "");
//		assertTrue(params != null);
//	}
//	
//	/** Tests that google-gruyere instance is vulnerable to (Stored) XSS if we have a known cookie.
//	 * @throws IOException
//	 * @throws URISyntaxException
//	 */
//	@Test
//	public void testGoogleGruyereisVulnerableStoredXSS() throws IOException, URISyntaxException{
//		List<String> params = AttackManager.attack("https://google-gruyere.appspot.com/683962442778/newsnippet.gtl", "./strings.json", "GRUYERE=91551079|asd||author; GRUYERE_ID=683962442778");
//		assertTrue(params!=null);
//	}
	
	@Test
	public void test() throws IOException, URISyntaxException{
		List<String> params = AttackManager.attack("http://192.168.0.13/dvwa/vulnerabilities/xss_r", "./strings.json", "security=medium; PHPSESSID=m2dq7eu91purjqeeeddgnbmpv7");
		assertTrue(params!=null);
	}
	
}
